{
  "hash": "3517fa2a7d893756b7b17c2d5e1422d9",
  "result": {
    "markdown": "---\ntitle: \"Randomized Controlled Trials\"\nauthor: \"Lucas Puebla\"\n---\n\n\n# Assignment 1\n\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-1_bc4b69d96fcc8ca5393fd3339f07d438'}\n\n```{.r .cell-code}\n# Load packages\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ dplyr     1.1.4     ✔ readr     2.1.4\n#> ✔ forcats   1.0.0     ✔ stringr   1.5.0\n#> ✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n#> ✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n#> ✔ purrr     1.0.2     \n#> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#> ✖ dplyr::filter() masks stats::filter()\n#> ✖ dplyr::lag()    masks stats::lag()\n#> ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(dagitty)\nlibrary(ggdag)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attaching package: 'ggdag'\n#> \n#> The following object is masked from 'package:stats':\n#> \n#>     filter\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggthemr)\nggthemr(\"flat\")\nrm(list = ls())\n\n# Load data\ndata <- readRDS(\"~/GitHub/cdsba-lucaspuebla93/Causal_Data_Science_Data/abtest_online.rds\")\nprint(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> # A tibble: 1,000 × 6\n#>    ip              chatbot previous_visit mobile_device purchase purchase_amount\n#>    <chr>           <lgl>            <dbl> <lgl>            <dbl>           <dbl>\n#>  1 161.88.211.70   TRUE                 0 FALSE                0             0  \n#>  2 239.86.201.0    TRUE                 1 FALSE                1            39.5\n#>  3 35.90.22.130    TRUE                 1 FALSE                0             0  \n#>  4 219.176.193.3   FALSE                4 TRUE                 0             0  \n#>  5 247.85.168.16   TRUE                 1 FALSE                0             0  \n#>  6 120.221.249.244 TRUE                 2 FALSE                0             0  \n#>  7 90.171.211.22   TRUE                 1 TRUE                 1            47.5\n#>  8 52.225.227.74   TRUE                 1 TRUE                 1            19.8\n#>  9 223.64.45.225   FALSE                1 TRUE                 0             0  \n#> 10 85.209.250.31   FALSE                0 FALSE                0             0  \n#> # ℹ 990 more rows\n```\n:::\n\n```{.r .cell-code}\n# Calculate summary statistics for mobile_device by group\nmobile_summary <- data %>%\n  group_by(chatbot) %>%\n  summarise(\n    prop_mobile_device = mean(mobile_device)\n  )\n\n# Calculate summary statistics for previous_visits by group\nvisits_summary <- data %>%\n  group_by(chatbot) %>%\n  summarise(\n    mean_visits = mean(previous_visit),\n    median_visits = median(previous_visit),\n    sd_visits = sd(previous_visit)\n  )\n\n# Display the calculated summary statistics\nmobile_summary\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"chatbot\"],\"name\":[1],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"prop_mobile_device\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"FALSE\",\"2\":\"0.3185484\"},{\"1\":\"TRUE\",\"2\":\"0.3154762\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nvisits_summary\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"chatbot\"],\"name\":[1],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"mean_visits\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"median_visits\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sd_visits\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"FALSE\",\"2\":\"2.169355\",\"3\":\"1\",\"4\":\"2.217367\"},{\"1\":\"TRUE\",\"2\":\"1.875000\",\"3\":\"1\",\"4\":\"1.875406\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# Check covariate balance for categorical variable (mobile_device)\nggplot(data, aes(x = as.factor(chatbot), fill = as.factor(mobile_device))) +\n  geom_bar(position = \"fill\") +\n  labs(x = \"Group\", y = \"Proportion\", fill = \"Mobile Device\", title = \"Comparison of Mobile Device Usage by Group\")\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Check covariate balance for another variable (previous_visits)\nggplot(data, aes(x = as.factor(chatbot), y = previous_visit)) +\n  geom_boxplot() +\n  labs(x = \"Group\", y = \"Previous Visits\", title = \"Comparison of Previous Visits by Group\")\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n:::\n\nThe proportion of users on mobile_device is almost equal in both groups.\nThe average number of previous_visit shows a slight difference between groups, but medians are identical. It seems that both groups are balanced in regard to these covariates\n\n\n\n# Assignment 2\n\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-2_568fbd4c35a98dc3a159ef5317e278e7'}\n\n```{.r .cell-code}\n# Fit a linear regression model\nmodel_1 <- lm(purchase_amount ~ chatbot, data = data)\n# Display the summary of the regression model\nsummary(model_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ chatbot, data = data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -16.702 -14.478  -9.626  13.922  64.648 \n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)  16.7017     0.8374  19.944  < 2e-16 ***\n#> chatbotTRUE  -7.0756     1.1796  -5.998 2.79e-09 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 18.65 on 998 degrees of freedom\n#> Multiple R-squared:  0.0348,\tAdjusted R-squared:  0.03383 \n#> F-statistic: 35.98 on 1 and 998 DF,  p-value: 2.787e-09\n```\n:::\n\n```{.r .cell-code}\n# Fit a linear regression model\nmodel_2 <- lm(purchase ~ chatbot, data = data)\n# Display the summary of the regression model\nsummary(model_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase ~ chatbot, data = data)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -0.4960 -0.3249 -0.2679  0.5040  0.7321 \n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)  0.49597    0.02122  23.376  < 2e-16 ***\n#> chatbotTRUE -0.22811    0.02989  -7.633 5.36e-14 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 0.4725 on 998 degrees of freedom\n#> Multiple R-squared:  0.05516,\tAdjusted R-squared:  0.05421 \n#> F-statistic: 58.26 on 1 and 998 DF,  p-value: 5.36e-14\n```\n:::\n:::\n\n\n\n# Assignment 3\n\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-3_931ce0549a60186a59bc58257cdbef2b'}\n\n```{.r .cell-code}\n# Fit a linear regression model with interaction for purchase_amount and chatbot by mobile_device\nmodel_interaction <- lm(purchase_amount ~ chatbot * mobile_device, data = data)\n\n# Display the summary of the regression model with interaction\nsummary(model_interaction)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ chatbot * mobile_device, data = data)\n#> \n#> Residuals:\n#>    Min     1Q Median     3Q    Max \n#> -16.98 -14.54  -9.95  14.13  65.24 \n#> \n#> Coefficients:\n#>                               Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)                    16.9797     1.0152  16.725   <2e-16 ***\n#> chatbotTRUE                    -7.0301     1.4284  -4.922    1e-06 ***\n#> mobile_deviceTRUE              -0.8727     1.7987  -0.485    0.628    \n#> chatbotTRUE:mobile_deviceTRUE  -0.1526     2.5369  -0.060    0.952    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 18.66 on 996 degrees of freedom\n#> Multiple R-squared:  0.03534,\tAdjusted R-squared:  0.03244 \n#> F-statistic: 12.16 on 3 and 996 DF,  p-value: 8.034e-08\n```\n:::\n:::\n\n\n\n# Assignment 4\n\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-4_fed94e882d4c905d665514f166b9bfda'}\n\n```{.r .cell-code}\n# Fit a logistic regression model for purchase and chatbot\nmodel_purchase <- glm(purchase ~ chatbot, data = data, family = \"binomial\")\n\n# Display the summary of the logistic regression model for purchase\nsummary(model_purchase)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> glm(formula = purchase ~ chatbot, family = \"binomial\", data = data)\n#> \n#> Coefficients:\n#>             Estimate Std. Error z value Pr(>|z|)    \n#> (Intercept) -0.01613    0.08981  -0.180    0.857    \n#> chatbotTRUE -0.98939    0.13484  -7.337 2.18e-13 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for binomial family taken to be 1)\n#> \n#>     Null deviance: 1329.1  on 999  degrees of freedom\n#> Residual deviance: 1273.3  on 998  degrees of freedom\n#> AIC: 1277.3\n#> \n#> Number of Fisher Scoring iterations: 4\n```\n:::\n:::\n\nHere, we can see that the coefficient for chatbot is statistically significant as indicated by the low p-value (p = 2.18e-13), The coefficient for chatbot=TRUE (-0.98939) represents the estimated log-odds ratio change in purchase behavior associated with the presence of the chatbot. Thus, the odds of making a purchase for customers exposed to the chatbot are expected to decrease by exp(-0.98939) ≈ 0.371 times compared to customers who were not exposed to the chatbot.\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}